{
  "hash": "b7b4ad87d16ad44d5641a06d75875c9e",
  "result": {
    "markdown": "---\ntitle: \"Assignment 3\"\nauthor: \"Ronald Bentil\"\ndate: \"2023-09-06\"\ncategories: [news, code, analysis]\ncode-fold: true\ncode-tools: true\n---\n\n## Description of dataset\n\nThe data was collected in the Luckhart lab using a locomotor activity monitor. The data represents individual counts of mosquito movements upon treatment with different concentrations of Serotonin which is a neuromodulator in the brain of insects and affects their behaviour.\n\n## Data collection\n\nMale mosquitoes were primed (treated) with 3 different concentrations (0.15uM, 1.5uM and 15uM) of Serotonin (5-HT) for three consecutive days.One group of males were allowed to mate with female mosquitoes (mated males) and another group non allowed to mate. Following this, their activity were measured.\n\n## Data prepration\n\nThe monitor records activity (up and down movement) from start of experiment till experiment is ended. However, because we the data of interest is circadian activity, the data was trimmed to a a 24-hour window starting from 7pm (12-hour dark period and 12-hour light period)\n\n\n## Describing variables in the data\n\nVariables in the dataset have are described in the data dictionary below\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.3     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.3     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(readxl)\nDAMdata <- read_excel(\"DAMdata.xlsx\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNew names:\n• `` -> `...1`\n• `` -> `...3`\n• `` -> `...4`\n• `` -> `...5`\n• `` -> `...6`\n• `` -> `...7`\n• `` -> `...8`\n• `` -> `...9`\n• `` -> `...11`\n• `` -> `...12`\n• `` -> `...13`\n• `` -> `...14`\n• `` -> `...15`\n• `` -> `...16`\n• `` -> `...17`\n• `` -> `...19`\n• `` -> `...20`\n• `` -> `...21`\n• `` -> `...22`\n• `` -> `...23`\n• `` -> `...24`\n• `` -> `...25`\n• `` -> `...27`\n• `` -> `...28`\n• `` -> `...29`\n• `` -> `...30`\n• `` -> `...31`\n• `` -> `...32`\n• `` -> `...33`\n```\n:::\n\n```{.r .cell-code}\nDAMdata.mated <- read_excel(\"DAMdata.xlsx\", sheet = \"mated\", skip=1)\n\nDAMdata.nonmated <- read_excel(\"DAMdata.xlsx\", sheet = \"non-mated\", skip=1)\n\nlibrary(tidyverse)\n\nlibrary(knitr)\ninvisible(library(kableExtra))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'kableExtra'\n\nThe following object is masked from 'package:dplyr':\n\n    group_rows\n```\n:::\n\n```{.r .cell-code}\nDAMdata.mated <- DAMdata.mated %>%\n  mutate(newtime=ymd_hms(Time))\n\nDAMdata.nonmated <- DAMdata.nonmated %>%\n  mutate(newtime=ymd_hms(Time))\n\n\nkable(head(DAMdata), caption = \"Table 1: Mosquito circadian activity\") %>%\n  kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Table 1: Mosquito circadian activity</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> ...1 </th>\n   <th style=\"text-align:left;\"> Control </th>\n   <th style=\"text-align:left;\"> ...3 </th>\n   <th style=\"text-align:left;\"> ...4 </th>\n   <th style=\"text-align:left;\"> ...5 </th>\n   <th style=\"text-align:left;\"> ...6 </th>\n   <th style=\"text-align:left;\"> ...7 </th>\n   <th style=\"text-align:left;\"> ...8 </th>\n   <th style=\"text-align:left;\"> ...9 </th>\n   <th style=\"text-align:left;\"> 0.15 μM 5-HT </th>\n   <th style=\"text-align:left;\"> ...11 </th>\n   <th style=\"text-align:left;\"> ...12 </th>\n   <th style=\"text-align:left;\"> ...13 </th>\n   <th style=\"text-align:left;\"> ...14 </th>\n   <th style=\"text-align:left;\"> ...15 </th>\n   <th style=\"text-align:left;\"> ...16 </th>\n   <th style=\"text-align:left;\"> ...17 </th>\n   <th style=\"text-align:left;\"> 1.5 μM 5-HT </th>\n   <th style=\"text-align:left;\"> ...19 </th>\n   <th style=\"text-align:left;\"> ...20 </th>\n   <th style=\"text-align:left;\"> ...21 </th>\n   <th style=\"text-align:left;\"> ...22 </th>\n   <th style=\"text-align:left;\"> ...23 </th>\n   <th style=\"text-align:left;\"> ...24 </th>\n   <th style=\"text-align:left;\"> ...25 </th>\n   <th style=\"text-align:left;\"> 15 μM 5-HT </th>\n   <th style=\"text-align:left;\"> ...27 </th>\n   <th style=\"text-align:left;\"> ...28 </th>\n   <th style=\"text-align:left;\"> ...29 </th>\n   <th style=\"text-align:left;\"> ...30 </th>\n   <th style=\"text-align:left;\"> ...31 </th>\n   <th style=\"text-align:left;\"> ...32 </th>\n   <th style=\"text-align:left;\"> ...33 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Time </td>\n   <td style=\"text-align:left;\"> M1 </td>\n   <td style=\"text-align:left;\"> M2 </td>\n   <td style=\"text-align:left;\"> M3 </td>\n   <td style=\"text-align:left;\"> M4 </td>\n   <td style=\"text-align:left;\"> M5 </td>\n   <td style=\"text-align:left;\"> M6 </td>\n   <td style=\"text-align:left;\"> M7 </td>\n   <td style=\"text-align:left;\"> M8 </td>\n   <td style=\"text-align:left;\"> M9 </td>\n   <td style=\"text-align:left;\"> M10 </td>\n   <td style=\"text-align:left;\"> M11 </td>\n   <td style=\"text-align:left;\"> M12 </td>\n   <td style=\"text-align:left;\"> M13 </td>\n   <td style=\"text-align:left;\"> M14 </td>\n   <td style=\"text-align:left;\"> M15 </td>\n   <td style=\"text-align:left;\"> M16 </td>\n   <td style=\"text-align:left;\"> M17 </td>\n   <td style=\"text-align:left;\"> M18 </td>\n   <td style=\"text-align:left;\"> M19 </td>\n   <td style=\"text-align:left;\"> M20 </td>\n   <td style=\"text-align:left;\"> M21 </td>\n   <td style=\"text-align:left;\"> M22 </td>\n   <td style=\"text-align:left;\"> M23 </td>\n   <td style=\"text-align:left;\"> M24 </td>\n   <td style=\"text-align:left;\"> M25 </td>\n   <td style=\"text-align:left;\"> M26 </td>\n   <td style=\"text-align:left;\"> M27 </td>\n   <td style=\"text-align:left;\"> M28 </td>\n   <td style=\"text-align:left;\"> M29 </td>\n   <td style=\"text-align:left;\"> M30 </td>\n   <td style=\"text-align:left;\"> M31 </td>\n   <td style=\"text-align:left;\"> M32 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 0.79166666666666663 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 7 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 8 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 0.79236111111111107 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 9 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 7 </td>\n   <td style=\"text-align:left;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 0.79305555555555562 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 5 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:left;\"> 5 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 6 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 0.79375000000000007 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 26 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 12 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 0.7944444444444444 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 22 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\nDAMdatadictionary <- read_excel(\"DAMdatadictionary.xlsx\")\n\nsuppressPackageStartupMessages(library(tidyverse))\nlibrary(readxl)\ninvisible(library(dplyr))\ninvisible(library(kableExtra))\n\nsuppressMessages({\n  DAMdatadictionary <- read_excel(\"DAMdatadictionary.xlsx\")\n  knitr::kable(DAMdatadictionary, caption = \"Table 2: Mosquito circadian activity data dictionary\") %>%\n    kable_styling()\n})\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Table 2: Mosquito circadian activity data dictionary</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Header </th>\n   <th style=\"text-align:left;\"> Definition </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Control </td>\n   <td style=\"text-align:left;\"> Sugar solution used in place of serotonin treatment </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 0.15uM 5-HT </td>\n   <td style=\"text-align:left;\"> Serotonin diluted to 0.15uM for priming mosquitoes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1.5uM 5-HT </td>\n   <td style=\"text-align:left;\"> Serotonin diluted to 1.5uM for priming mosquitoes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 15uM 5-HT </td>\n   <td style=\"text-align:left;\"> Serotonin diluted to 15uM for priming mosquitoes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Time </td>\n   <td style=\"text-align:left;\"> 24-hour window activity was measured </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n## Data wrangling\n\nReassign treatment values to columns\nsummarize counts to hours \nsummarize into treatments\n\n\n## MATED PLOT\n\n::: {.cell}\n\n```{.r .cell-code}\nDAMdata.mated <- read_excel(\"DAMdata.xlsx\", sheet = \"mated\", skip=1)\n\nnewDAM.mated <- DAMdata.mated %>%\n  pivot_longer(cols = !Time, names_to = \"ID\", values_to = \"Activity\") %>%\n  mutate(\n    Treatment = case_when(\n      as.numeric(str_extract(ID, \"\\\\d+\")) <= 8  ~ \"Control\",\n      as.numeric(str_extract(ID, \"\\\\d+\")) <= 16 ~ \"0.15uM Serotonin\",\n      as.numeric(str_extract(ID, \"\\\\d+\")) <= 24 ~ \"1.5uM Serotonin\",\n      as.numeric(str_extract(ID, \"\\\\d+\")) <= 32 ~ \"15uM Serotonin\",\n      TRUE                                          ~ \"Other\"\n    )\n  )\n\nkable(head(newDAM.mated), caption = \"Table 3: Mosquito circadian activity\") %>%\n  kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Table 3: Mosquito circadian activity</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Time </th>\n   <th style=\"text-align:left;\"> ID </th>\n   <th style=\"text-align:right;\"> Activity </th>\n   <th style=\"text-align:left;\"> Treatment </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1899-12-31 19:00:00 </td>\n   <td style=\"text-align:left;\"> M1 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Control </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1899-12-31 19:00:00 </td>\n   <td style=\"text-align:left;\"> M2 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Control </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1899-12-31 19:00:00 </td>\n   <td style=\"text-align:left;\"> M3 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Control </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1899-12-31 19:00:00 </td>\n   <td style=\"text-align:left;\"> M4 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Control </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1899-12-31 19:00:00 </td>\n   <td style=\"text-align:left;\"> M5 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Control </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1899-12-31 19:00:00 </td>\n   <td style=\"text-align:left;\"> M6 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Control </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lubridate)\n\nsum.mated <- newDAM.mated %>%\n  mutate(hour_bin = floor_date(Time, unit = \"hour\")) %>%\n  group_by(hour_bin, Treatment) %>%\n  summarise(Total_Activity = sum(Activity), .groups = 'drop')\n\nkable(head(sum.mated), caption = \"Table 3: Mosquito circadian activity\") %>%\n  kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Table 3: Mosquito circadian activity</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> hour_bin </th>\n   <th style=\"text-align:left;\"> Treatment </th>\n   <th style=\"text-align:right;\"> Total_Activity </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1899-12-31 00:00:00 </td>\n   <td style=\"text-align:left;\"> 0.15uM Serotonin </td>\n   <td style=\"text-align:right;\"> 14 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1899-12-31 00:00:00 </td>\n   <td style=\"text-align:left;\"> 1.5uM Serotonin </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1899-12-31 00:00:00 </td>\n   <td style=\"text-align:left;\"> 15uM Serotonin </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1899-12-31 00:00:00 </td>\n   <td style=\"text-align:left;\"> Control </td>\n   <td style=\"text-align:right;\"> 43 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1899-12-31 01:00:00 </td>\n   <td style=\"text-align:left;\"> 0.15uM Serotonin </td>\n   <td style=\"text-align:right;\"> 5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1899-12-31 01:00:00 </td>\n   <td style=\"text-align:left;\"> 1.5uM Serotonin </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(scales)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'scales'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:purrr':\n\n    discard\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:readr':\n\n    col_factor\n```\n:::\n\n```{.r .cell-code}\nggplot(sum.mated, aes(x=hour_bin, y=Total_Activity))+\n  geom_col()+\n  facet_wrap(~Treatment, ncol = 1)+\n  scale_x_datetime(labels = date_format(\"%H:%M\")) \n```\n\n::: {.cell-output-display}\n![](UntitledQMD_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n## NON-MATED PLOT\n\n::: {.cell}\n\n```{.r .cell-code}\nDAMdata.nonmated <- read_excel(\"DAMdata.xlsx\", sheet = \"non-mated\", skip=1)\n\nnewDAM.nonmated <- DAMdata.nonmated %>%\n  pivot_longer(cols = !Time, names_to = \"ID\", values_to = \"Activity\") %>%\n  mutate(\n    Treatment = case_when(\n      as.numeric(str_extract(ID, \"\\\\d+\")) <= 8  ~ \"Control\",\n      as.numeric(str_extract(ID, \"\\\\d+\")) <= 16 ~ \"0.15uM Serotonin\",\n      as.numeric(str_extract(ID, \"\\\\d+\")) <= 24 ~ \"1.5uM Serotonin\",\n      as.numeric(str_extract(ID, \"\\\\d+\")) <= 32 ~ \"15uM Serotonin\",\n      TRUE                                          ~ \"Other\"\n    )\n  )\n\nkable(head(newDAM.nonmated), caption = \"Table 3: Mosquito circadian activity\") %>%\n  kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Table 3: Mosquito circadian activity</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Time </th>\n   <th style=\"text-align:left;\"> ID </th>\n   <th style=\"text-align:right;\"> Activity </th>\n   <th style=\"text-align:left;\"> Treatment </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1899-12-31 19:00:00 </td>\n   <td style=\"text-align:left;\"> M1 </td>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:left;\"> Control </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1899-12-31 19:00:00 </td>\n   <td style=\"text-align:left;\"> M2 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:left;\"> Control </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1899-12-31 19:00:00 </td>\n   <td style=\"text-align:left;\"> M3 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Control </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1899-12-31 19:00:00 </td>\n   <td style=\"text-align:left;\"> M4 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Control </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1899-12-31 19:00:00 </td>\n   <td style=\"text-align:left;\"> M5 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> Control </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1899-12-31 19:00:00 </td>\n   <td style=\"text-align:left;\"> M6 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Control </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lubridate)\n\nsum.nonmated <- newDAM.nonmated %>%\n  mutate(hour_bin = floor_date(Time, unit = \"hour\")) %>%\n  group_by(hour_bin, Treatment) %>%\n  summarise(Total_Activity = sum(Activity), .groups = 'drop')\n\nkable(head(sum.nonmated), caption = \"Table 3: Mosquito circadian activity\") %>%\n  kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Table 3: Mosquito circadian activity</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> hour_bin </th>\n   <th style=\"text-align:left;\"> Treatment </th>\n   <th style=\"text-align:right;\"> Total_Activity </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1899-12-31 00:00:00 </td>\n   <td style=\"text-align:left;\"> 0.15uM Serotonin </td>\n   <td style=\"text-align:right;\"> 24 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1899-12-31 00:00:00 </td>\n   <td style=\"text-align:left;\"> 1.5uM Serotonin </td>\n   <td style=\"text-align:right;\"> 20 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1899-12-31 00:00:00 </td>\n   <td style=\"text-align:left;\"> 15uM Serotonin </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1899-12-31 00:00:00 </td>\n   <td style=\"text-align:left;\"> Control </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1899-12-31 01:00:00 </td>\n   <td style=\"text-align:left;\"> 0.15uM Serotonin </td>\n   <td style=\"text-align:right;\"> 11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1899-12-31 01:00:00 </td>\n   <td style=\"text-align:left;\"> 1.5uM Serotonin </td>\n   <td style=\"text-align:right;\"> 24 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(scales)\n\nggplot(sum.nonmated, aes(x=hour_bin, y=Total_Activity))+\n  geom_col()+\n  facet_wrap(~Treatment, ncol = 1)+\n  scale_x_datetime(labels = date_format(\"%H:%M\")) \n```\n\n::: {.cell-output-display}\n![](UntitledQMD_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "UntitledQMD_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}